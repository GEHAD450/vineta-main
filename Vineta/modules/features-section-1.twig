
{% if not settings.hide_all_section %}
<section section-id="{{ sectionId }}" 
         style="{% if settings.bg_color %}background-color:{{ settings.bg_color }};{% endif %} {% if settings.bg_img %}background-image:url({{ settings.bg_img }});background-size: cover; background-position: center; {% if settings.bg_attachment %} background-attachment: fixed;{% endif %}{% endif %}"
         class="featured__product--thumbnail-section pb-{% if settings.padding_bottom and settings.padding_bottom != 'default' %}{{ settings.padding_bottom }}{% else %}80{% endif %} pt-{% if settings.padding_top and settings.padding_top != 'default' %}{{ settings.padding_top }}{% else %}80{% endif %}">
   
  {% if settings.overlay %}
    <div class="overlay" style="{% if settings.overlay_color %}background-color:{{ settings.overlay_color }};{% endif %} {% if settings.overlay_opacity %}opacity:{{ settings.overlay_opacity }};{% endif %}"></div>
  {% endif %}
   
  <div class="{% if settings.full_width %} container-fluid {% else %} container custom-container {% endif %}">
      
    {% if settings.sub_title or settings.section_title %}
    <div class="title-area {% if settings.title_center %}center{% endif %} pb-{% if settings.title_padding_bottom and settings.title_padding_bottom != 'default' %}{{ settings.title_padding_bottom }}{% else %}50{% endif %}">
      {% if settings.sub_title %}
        <h4 class="sub-title" style="{% if settings.sub_title_color %}color:{{ settings.sub_title_color }};{% endif %}">{{ settings.sub_title }}</h4>
      {% endif %}
      {% if settings.section_title %}
        <h2 class="section-title" style="{% if settings.title_color %}color:{{ settings.title_color }};{% endif %}">
          {{ settings.section_title }}
        </h2>
      {% endif %}
    </div>
    {% endif %}

    <!-- Featured Product Thumbnail Slider -->
    <div class="featured__product--thumbnail-wrapper">
      <div class="featured__product--thumbnail">
        <div class="horizontal-slider-container" id="featured-slider-{{ sectionId }}">
          <div class="slider-track">
            <!-- Original Images -->
            {% for image in settings.slider_images %}
            {% if image.image %}
              <div class="slide-item">
                {% if image.link %}
                  <a href="{{ image.link }}" {% if image.new_tab %} target="_blank" {% endif %}>
                    <img loading="{% if loop.first %}eager{% else %}lazy{% endif %}" 
                         class="featured__product--thumbnail__img display-block"
                         src="{{ imageUrl(image.image, { w: 'auto', q: 'auto', f: 'auto' }) }}"
                         alt="{{ image.alt ? image.alt : 'Featured Product Image' }}">
                  </a>
                {% else %}
                  <img loading="{% if loop.first %}eager{% else %}lazy{% endif %}" 
                       class="featured__product--thumbnail__img display-block"
                       src="{{ imageUrl(image.image, { w: 'auto', q: 'auto', f: 'auto' }) }}"
                       alt="{{ image.alt ? image.alt : 'Featured Product Image' }}">
                {% endif %}
              </div>
            {% endif %}
            {% endfor %}
            
            <!-- Duplicate Images for Seamless Loop -->
            {% for image in settings.slider_images %}
            {% if image.image %}
              <div class="slide-item slide-duplicate">
                {% if image.link %}
                  <a href="{{ image.link }}" {% if image.new_tab %} target="_blank" {% endif %}>
                    <img loading="lazy" 
                         class="featured__product--thumbnail__img display-block"
                         src="{{ imageUrl(image.image, { w: 'auto', q: 'auto', f: 'auto' }) }}"
                         alt="{{ image.alt ? image.alt : 'Featured Product Image' }}">
                  </a>
                {% else %}
                  <img loading="lazy" 
                       class="featured__product--thumbnail__img display-block"
                       src="{{ imageUrl(image.image, { w: 'auto', q: 'auto', f: 'auto' }) }}"
                       alt="{{ image.alt ? image.alt : 'Featured Product Image' }}">
                {% endif %}
              </div>
            {% endif %}
            {% endfor %}
          </div>
        </div>
      </div>
    </div>

   </div>
</section>

<!-- CSS Styles for Features Section Slider Only - Scoped to avoid conflicts -->
<style>
/* Scoped to features-section-1 only */
.featured__product--thumbnail-section .featured__product--thumbnail {
  width: 100%;
  height: {% if settings.slider_height %}{{ settings.slider_height }}px{% else %}400px{% endif %};
  overflow: hidden;
  position: relative;
  border-radius: 12px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
}

.featured__product--thumbnail-section .horizontal-slider-container {
  width: 100%;
  height: 100%;
  overflow: hidden;
  position: relative;
}

.featured__product--thumbnail-section .slider-track {
  display: flex;
  width: fit-content;
  height: 100%;
  animation: featuresSlideHorizontal {% if settings.animation_speed %}{{ settings.animation_speed }}s{% else %}20s{% endif %} linear infinite;
  {% if settings.pause_on_hover %}animation-play-state: running;{% endif %}
}

{% if settings.pause_on_hover %}
.featured__product--thumbnail-section .slider-track:hover {
  animation-play-state: paused;
}
{% endif %}

.featured__product--thumbnail-section .slide-item {
  flex-shrink: 0;
  width: 300px;
  height: 100%;
  margin-right: 20px;
  position: relative;
  overflow: hidden;
  border-radius: 8px;
  transition: transform 0.3s ease;
}

.featured__product--thumbnail-section .slide-item:hover {
  transform: scale(1.05);
  z-index: 2;
}

.featured__product--thumbnail-section .featured__product--thumbnail__img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
  transition: transform 0.3s ease;
}

.featured__product--thumbnail-section .slide-item:hover .featured__product--thumbnail__img {
  transform: scale(1.1);
}

/* Animation keyframes - unique name to avoid conflicts */
@keyframes featuresSlideHorizontal {
  0% {
    transform: translateX(0);
  }
  100% {
    transform: translateX(-50%);
  }
}

/* RTL Support */
[dir="rtl"] .featured__product--thumbnail-section .slider-track {
  animation-name: featuresSlideHorizontalRTL;
}

@keyframes featuresSlideHorizontalRTL {
  0% {
    transform: translateX(0);
  }
  100% {
    transform: translateX(50%);
  }
}

/* Responsive Design */
@media (max-width: 768px) {
  .featured__product--thumbnail-section .featured__product--thumbnail {
    height: 250px;
  }
  
  .featured__product--thumbnail-section .slide-item {
    width: 200px;
    margin-right: 15px;
  }
  
  .featured__product--thumbnail-section .slider-track {
    animation-duration: 15s;
  }
}

@media (max-width: 480px) {
  .featured__product--thumbnail-section .featured__product--thumbnail {
    height: 200px;
  }
  
  .featured__product--thumbnail-section .slide-item {
    width: 150px;
    margin-right: 10px;
  }
}
</style>

<!-- JavaScript for Enhanced Functionality -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  const sliderId = 'featured-slider-{{ sectionId }}';
  const sliderContainer = document.getElementById(sliderId);
  const sliderTrack = sliderContainer ? sliderContainer.querySelector('.slider-track') : null;
  
  if (sliderTrack) {
    console.log('Featured Product Thumbnail Slider initialized:', sliderId);
    
    // Add intersection observer for performance
    if ('IntersectionObserver' in window) {
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            sliderTrack.style.animationPlayState = 'running';
          } else {
            sliderTrack.style.animationPlayState = 'paused';
          }
        });
      }, { threshold: 0.1 });
      
      observer.observe(sliderContainer);
    }
    
    // Handle visibility change
    document.addEventListener('visibilitychange', function() {
      if (document.hidden) {
        sliderTrack.style.animationPlayState = 'paused';
      } else {
        sliderTrack.style.animationPlayState = 'running';
      }
    });
    
    // Add keyboard navigation
    sliderContainer.addEventListener('keydown', function(e) {
      if (e.key === 'Space' || e.key === ' ') {
        e.preventDefault();
        const currentState = sliderTrack.style.animationPlayState;
        sliderTrack.style.animationPlayState = currentState === 'paused' ? 'running' : 'paused';
      }
    });
    
    // Make container focusable for keyboard navigation
    sliderContainer.setAttribute('tabindex', '0');
    sliderContainer.setAttribute('aria-label', 'Featured Products Slider - Press Space to pause/resume');
  }
});
</script>
{% endif %}

{% schema %}
{
  "name": {
    "ar": "سلايدر الصور الأفقي المتحرك",
    "en": "Horizontal Continuous Image Slider"
  },
  "icon": "fal fa-images",
  "display": true,
  "settings": {
    "hide_all_section": {
      "type": "checkbox",
      "label": {
        "ar": " ",
        "en": " "
      },
      "option": {
        "ar": "إخفاء القسم",
        "en": "Hide Section"
      },
      "noLabel": true
    },
    "full_width": {
      "type": "checkbox",
      "label": {
        "ar": " ",
        "en": " "
      },
      "option": {
        "ar": "عرض كامل الشاشة",
        "en": "Full Width"
      },
      "noLabel": true,
      "default": false
    },
    "padding_top" : {
      "type":"select",
      "label": {
        "ar": "التباعد العلوي للقسم القيمة الافتراضية هي (80)",
        "en": "Section Padding Top (Default is 80)"
      },
      "options": [
        {
          "value": "default",
          "label": {
            "ar": "القيمة الافتراضية",
            "en": "Default"
          }
        },
        {
          "value": "00",
          "label": {
            "ar": "0",
            "en": "0"
          }
        },
        {
          "value": "10",
          "label": {
            "ar": "10",
            "en": "10"
          }
        },
        {
          "value": "20",
          "label": {
            "ar": "20",
            "en": "20"
          }
        },
        {
          "value": "30",
          "label": {
            "ar": "30",
            "en": "30"
          }
        },
        {
          "value": "40",
          "label": {
            "ar": "40",
            "en": "40"
          }
        },
        {
          "value": "50",
          "label": {
            "ar": "50",
            "en": "50"
          }
        },
        {
          "value": "60",
          "label": {
            "ar": "60",
            "en": "60"
          }
        },
        {
          "value": "70",
          "label": {
            "ar": "70",
            "en": "70"
          }
        },
        {
          "value": "80",
          "label": {
            "ar": "80",
            "en": "80"
          }
        },
        {
          "value": "90",
          "label": {
            "ar": "90",
            "en": "90"
          }
        },
        {
          "value": "100",
          "label": {
            "ar": "100",
            "en": "100"
          }
        },
        {
          "value": "110",
          "label": {
            "ar": "110",
            "en": "110"
          }
        },
        {
          "value": "120",
          "label": {
            "ar": "120",
            "en": "120"
          }
        },
        {
          "value": "130",
          "label": {
            "ar": "130",
            "en": "130"
          }
        },
        {
          "value": "140",
          "label": {
            "ar": "140",
            "en": "140"
          }
        },
        {
          "value": "150",
          "label": {
            "ar": "150",
            "en": "150"
          }
        },
        {
          "value": "160",
          "label": {
            "ar": "160",
            "en": "160"
          }
        },
        {
          "value": "170",
          "label": {
            "ar": "170",
            "en": "170"
          }
        },
        {
          "value": "180",
          "label": {
            "ar": "180",
            "en": "180"
          }
        },
        {
          "value": "190",
          "label": {
            "ar": "190",
            "en": "190"
          }
        },
        {
          "value": "200",
          "label": {
            "ar": "200",
            "en": "200"
          }
        }
      ],
      "default": "80"
    },
    "padding_bottom" : {
      "type":"select",
      "label": {
        "ar": "التباعد السفلي للقسم القيمة الافتراضية هي (80)",
        "en": "Section Padding Bottom (Default is 80)"
      },
      "options": [
        {
          "value": "default",
          "label": {
            "ar": "القيمة الافتراضية",
            "en": "Default"
          }
        },
        {
          "value": "00",
          "label": {
            "ar": "0",
            "en": "0"
          }
        },
        {
          "value": "10",
          "label": {
            "ar": "10",
            "en": "10"
          }
        },
        {
          "value": "20",
          "label": {
            "ar": "20",
            "en": "20"
          }
        },
        {
          "value": "30",
          "label": {
            "ar": "30",
            "en": "30"
          }
        },
        {
          "value": "40",
          "label": {
            "ar": "40",
            "en": "40"
          }
        },
        {
          "value": "50",
          "label": {
            "ar": "50",
            "en": "50"
          }
        },
        {
          "value": "60",
          "label": {
            "ar": "60",
            "en": "60"
          }
        },
        {
          "value": "70",
          "label": {
            "ar": "70",
            "en": "70"
          }
        },
        {
          "value": "80",
          "label": {
            "ar": "80",
            "en": "80"
          }
        },
        {
          "value": "90",
          "label": {
            "ar": "90",
            "en": "90"
          }
        },
        {
          "value": "100",
          "label": {
            "ar": "100",
            "en": "100"
          }
        },
        {
          "value": "110",
          "label": {
            "ar": "110",
            "en": "110"
          }
        },
        {
          "value": "120",
          "label": {
            "ar": "120",
            "en": "120"
          }
        },
        {
          "value": "130",
          "label": {
            "ar": "130",
            "en": "130"
          }
        },
        {
          "value": "140",
          "label": {
            "ar": "140",
            "en": "140"
          }
        },
        {
          "value": "150",
          "label": {
            "ar": "150",
            "en": "150"
          }
        },
        {
          "value": "160",
          "label": {
            "ar": "160",
            "en": "160"
          }
        },
        {
          "value": "170",
          "label": {
            "ar": "170",
            "en": "170"
          }
        },
        {
          "value": "180",
          "label": {
            "ar": "180",
            "en": "180"
          }
        },
        {
          "value": "190",
          "label": {
            "ar": "190",
            "en": "190"
          }
        },
        {
          "value": "200",
          "label": {
            "ar": "200",
            "en": "200"
          }
        }
      ],
      "default": "80"
    },
    "sub_title": {
      "type": "text",
      "label": {
        "ar": "العنوان الفرعي",
        "en": "Sub Title"
      }
    },
    "sub_title_color": {
      "type": "color",
      "label": {
        "ar": "لون العنوان الفرعي",
        "en": "Sub Title Color"
      }
    },
    "section_title": {
      "type": "text",
      "label": {
        "ar": "العنوان",
        "en": "Title"
      }
    },
    "title_color": {
      "type": "color",
      "label": {
        "ar": "لون العنوان",
        "en": "Title Color"
      }
    },
    "title_center": {
      "type": "checkbox",
      "label": {
        "ar": " ",
        "en": " "
      },
      "option": {
        "ar": "توسيط العنوان والعنوان الفرعي",
        "en": "Center Title and Sub Title"
      },
      "noLabel": true
    },
    "title_padding_bottom" : {
      "type":"select",
      "label": {
        "ar": "التباعد السفلي للعنوان القيمة الافتراضية هي (50)",
        "en": "Title Padding Bottom (Default is 50)"
      },
      "options": [
        {
          "value": "default",
          "label": {
            "ar": "القيمة الافتراضية",
            "en": "Default"
          }
        },
        {
          "value": "00",
          "label": {
            "ar": "0",
            "en": "0"
          }
        },
        {
          "value": "10",
          "label": {
            "ar": "10",
            "en": "10"
          }
        },
        {
          "value": "20",
          "label": {
            "ar": "20",
            "en": "20"
          }
        },
        {
          "value": "30",
          "label": {
            "ar": "30",
            "en": "30"
          }
        },
        {
          "value": "40",
          "label": {
            "ar": "40",
            "en": "40"
          }
        },
        {
          "value": "50",
          "label": {
            "ar": "50",
            "en": "50"
          }
        },
        {
          "value": "60",
          "label": {
            "ar": "60",
            "en": "60"
          }
        },
        {
          "value": "70",
          "label": {
            "ar": "70",
            "en": "70"
          }
        },
        {
          "value": "80",
          "label": {
            "ar": "80",
            "en": "80"
          }
        },
        {
          "value": "90",
          "label": {
            "ar": "90",
            "en": "90"
          }
        },
        {
          "value": "100",
          "label": {
            "ar": "100",
            "en": "100"
          }
        },
        {
          "value": "110",
          "label": {
            "ar": "110",
            "en": "110"
          }
        },
        {
          "value": "120",
          "label": {
            "ar": "120",
            "en": "120"
          }
        },
        {
          "value": "130",
          "label": {
            "ar": "130",
            "en": "130"
          }
        },
        {
          "value": "140",
          "label": {
            "ar": "140",
            "en": "140"
          }
        },
        {
          "value": "150",
          "label": {
            "ar": "150",
            "en": "150"
          }
        },
        {
          "value": "160",
          "label": {
            "ar": "160",
            "en": "160"
          }
        },
        {
          "value": "170",
          "label": {
            "ar": "170",
            "en": "170"
          }
        },
        {
          "value": "180",
          "label": {
            "ar": "180",
            "en": "180"
          }
        },
        {
          "value": "190",
          "label": {
            "ar": "190",
            "en": "190"
          }
        },
        {
          "value": "200",
          "label": {
            "ar": "200",
            "en": "200"
          }
        }
      ],
      "default": "80"
    },
    "bg_color": {
      "type": "color",
      "label": {
        "ar": "لون الخلفية",
        "en": "Background Color"
      }
    },
    "bg_img": {
      "type": "image",
      "label": {
        "ar": "صورة الخلفية",
        "en": "Background Image"
      }
    },
    "bg_attachment": {
      "type": "checkbox",
      "option": {
        "ar": "صورة الخلفية متحركة",
        "en": "Background Image is Fixed"
      },
      "info": {
        "ar": "يمكنك تحديد ما إذا كانت صورة الخلفية ستكون متحركة أو ثابتة",
        "en": "You can set if the background image will be fixed or not"
      },
      "noLabel": true
    },
    "overlay": {
      "type": "checkbox",
      "label": {
        "ar": " ",
        "en": " "
      },
      "option": {
        "ar": "إظهار الغطاء المتداخل",
        "en": "Show Overlay"
      },
      "noLabel": true
    },
    "overlay_color": {
      "type": "color",
      "label": {
        "ar": "لون الغطاء المتداخل",
        "en": "Overlay Color"
      },
      "default": "#000000"
    },
    "overlay_opacity": {
      "type": "number",
      "label": {
        "ar": "شفافية الغطاء المتداخل",
        "en": "Overlay Opacity"
      },
      "info": {
        "ar": "يمكنك تحديد شفافية الغطاء بين 0 و 1 مثل 0.5",
        "en": "You can set the overlay opacity between 0 and 1 like 0.5"
      },
      "min": 0,
      "max": 1
    },
    "animation_speed": {
      "type": "number",
      "label": {
        "ar": "سرعة الحركة (ثانية)",
        "en": "Animation Speed (seconds)"
      },
      "default": 20,
      "min": 5,
      "max": 60
    },
    "pause_on_hover": {
      "type": "checkbox",
      "option": {
        "ar": "إيقاف الحركة عند التمرير",
        "en": "Pause on Hover"
      },
      "noLabel": true,
      "default": true
    },
    "slider_height": {
      "type": "number",
      "label": {
        "ar": "ارتفاع السلايدر",
        "en": "Slider Height"
      },
      "default": 400,
      "min": 200,
      "max": 800
    },
    "slider_images": {
      "type": "list",
      "noLabel": true,
      "settings_label": { "ar": "صورة", "en": "Image" },
      "maxItems": 6,
      "settings": {
        "image": {
          "type": "image",
          "label": { "ar": "صورة", "en": "Image" }
        },
        "link": {
          "type": "url",
          "label": { "ar": "الرابط", "en": "Link" }
        },
        "new_tab": {
          "type": "checkbox",
          "option": { "ar": "فتح في علامة تبويب جديدة", "en": "Open in new tab" },
          "noLabel": true
        }
      }
    }
  }
}
{% endschema %}
